<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: game.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: game.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Global variables for game state and elements.
 */
let canvas;
let ctx;
let gameStarted = false;
let world;
let keyboard = new Keyboard();
let winSound = new Audio('audio/backgound_musik/177304__lenguaverde__jarabe-tapatio-mariachi (1).mp3');
let gameOverSound = new Audio('audio/backgound_musik/76376__deleted_user_877451__game_over.wav');

/**
 * Initializes the game by setting up the canvas and displaying the start screen.
 */
function init() {
    canvas = document.getElementById('canvas');
    ctx = canvas.getContext('2d');
    showStartScreen(); // Zeige das Startbild zuerst
}

/**
 * Displays the start screen.
 */
function showStartScreen() {
    let startImage = new Image();
    startImage.src = 'img/9_intro_outro_screens/start/startscreen_1.png';
    
    startImage.onload = function () {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(startImage, 0, 0, canvas.width, canvas.height);
    };
}

/**
 * Starts the game if it hasn't been started already.
 */
function startGame() {
    if (!gameStarted) {
        gameStarted = true;
        keyboard = new Keyboard();
        world = new World(canvas, keyboard); // Welt mit Keyboard verbinden
        world.run();

        let swapButton = document.getElementById("swap-controls-btn");
        if (swapButton) {
            swapButton.style.display = "none";
        }

        requestAnimationFrame(() => world.draw());
    }
}

/**
 * Displays the win screen and stops the game.
 */
function showWinScreen() {
    stopGame();
    stopAllSounds();
    winSound.play();

    let canvasContainer = document.getElementById('canvas-container');
    let winOverlay = document.createElement('div');
    winOverlay.id = 'win-screen';
    winOverlay.style = "position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: rgba(0, 0, 0, 0.4); z-index: 10;";

    let winImage = new Image();
    winImage.src = 'img/9_intro_outro_screens/win/win_2.png';
    winImage.style.width = '40%';

    let restartButton = createMenuButton("Menue", restartGame);

    winOverlay.appendChild(winImage);
    winOverlay.appendChild(restartButton);
    canvasContainer.appendChild(winOverlay);
}

/**
 * Displays the game over screen and stops the game.
 */
function showGameOverScreen() {
    stopGame();
    stopAllSounds();
    gameOverSound.play();

    let canvasContainer = document.getElementById('canvas-container');
    let gameOverOverlay = document.createElement('div');
    gameOverOverlay.id = 'game-over-screen';
    gameOverOverlay.style = "position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: rgba(0, 0, 0, 0.4); z-index: 10;";

    let gameOverImage = new Image();
    gameOverImage.src = 'img/9_intro_outro_screens/game_over/game over!.png';
    gameOverImage.style.width = '70%';

    let restartButton = createMenuButton("Menue", restartGame);

    gameOverOverlay.appendChild(gameOverImage);
    gameOverOverlay.appendChild(restartButton);
    canvasContainer.appendChild(gameOverOverlay);
}

/**
 * Stops the game by clearing animations and preventing movement.
 */
function stopGame() {
    if (world) {
        clearInterval(world.animationInterval);
        world.character.speed = 0;
        world.keyboard = new Keyboard();
    }
}

/**
 * Stops all game sounds.
 */
function stopAllSounds() {
    if (world &amp;&amp; world.level.enimies) {
        world.level.enimies.forEach(enemy => {
            if (enemy instanceof ChickenBoss || enemy instanceof Chicken) {
                if (enemy.CHICKEN_BOSS_SOUND) {
                    enemy.CHICKEN_BOSS_SOUND.pause();
                    enemy.CHICKEN_BOSS_SOUND.currentTime = 0;
                }
                if (enemy.chicken_sound) {
                    enemy.chicken_sound.pause();
                    enemy.chicken_sound.currentTime = 0;
                }
            }
        });
    }

    let allSounds = document.querySelectorAll("audio");
    allSounds.forEach(sound => {
        sound.pause();
        sound.currentTime = 0;
    });
}

/**
 * Changes the play button to a restart button.
 */
function changePlayButtonToRestart() {
    let playButton = document.querySelector('.play-btn');
    playButton.innerText = "Menue";
    playButton.onclick = restartGame;

    playButton.style.display = "none";
    setTimeout(() => {
        playButton.style.display = "inline-block";
    }, 50);
}

/**
 * Reloads the page to restart the game.
 */
function restartGame() {
    location.reload();
}

/**
 * Creates a menu button.
 * @param {string} text - The button text.
 * @param {Function} callback - The function to execute when clicked.
 * @returns {HTMLButtonElement} The created button.
 */
function createMenuButton(text, callback) {
    let button = document.createElement('button');
    button.innerText = text;
    button.style = "padding: 15px 30px; font-size: 20px; margin-top: 20px; cursor: pointer; border: none; font-family: la-Tequila; border-radius: 10px; background: #e05606; color: #000; font-weight: bold;";
    button.addEventListener("click", callback);
    return button;
}

/**
 * Event listener for keyboard controls.
 */
window.addEventListener('keydown', (e) => {
    switch (e.keyCode) {
        case 39: keyboard.RIGHT = true; break;
        case 37: keyboard.LEFT = true; break;
        case 38: keyboard.UP = true; break;
        case 40: keyboard.DOWN = true; break;
        case 32: keyboard.SPACE = true; break;
        case 68: keyboard.D = true; break;
    }
});

/**
 * Event listener for releasing keyboard controls.
 */
window.addEventListener('keyup', (e) => {
    switch (e.keyCode) {
        case 39: keyboard.RIGHT = false; break;
        case 37: keyboard.LEFT = false; break;
        case 38: keyboard.UP = false; break;
        case 40: keyboard.DOWN = false; break;
        case 32: keyboard.SPACE = false; break;
        case 68: 
            keyboard.D = false;
            world.canThrow = true;
            break;
    }
});

/**
 * Adds touch controls for mobile users.
 */
document.addEventListener("DOMContentLoaded", function () {
    let leftBtn = document.getElementById("left-btn");
    let rightBtn = document.getElementById("right-btn");
    let jumpBtn = document.getElementById("jump-btn");
    let throwBtn = document.getElementById("throw-btn");

    function activateKey(key) {
        if (world &amp;&amp; world.keyboard) {
            world.keyboard[key] = true;
        }
    }

    function deactivateKey(key) {
        if (world &amp;&amp; world.keyboard) {
            world.keyboard[key] = false;
        }
    }

    function preventDefaultTouch(e) {
        if (e.cancelable) e.preventDefault();
    }

    leftBtn.addEventListener("touchstart", (e) => { preventDefaultTouch(e); activateKey("LEFT"); });
    leftBtn.addEventListener("touchend", (e) => { preventDefaultTouch(e); deactivateKey("LEFT"); });

    rightBtn.addEventListener("touchstart", (e) => { preventDefaultTouch(e); activateKey("RIGHT"); });
    rightBtn.addEventListener("touchend", (e) => { preventDefaultTouch(e); deactivateKey("RIGHT"); });

    jumpBtn.addEventListener("touchstart", (e) => { preventDefaultTouch(e); activateKey("SPACE"); });
    jumpBtn.addEventListener("touchend", (e) => { preventDefaultTouch(e); deactivateKey("SPACE"); });

    throwBtn.addEventListener("touchstart", (e) => { preventDefaultTouch(e); activateKey("D"); });
    throwBtn.addEventListener("touchend", (e) => { preventDefaultTouch(e); deactivateKey("D"); });
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#canvas">canvas</a></li><li><a href="global.html#changePlayButtonToRestart">changePlayButtonToRestart</a></li><li><a href="global.html#createMenuButton">createMenuButton</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#restartGame">restartGame</a></li><li><a href="global.html#showGameOverScreen">showGameOverScreen</a></li><li><a href="global.html#showStartScreen">showStartScreen</a></li><li><a href="global.html#showWinScreen">showWinScreen</a></li><li><a href="global.html#startGame">startGame</a></li><li><a href="global.html#stopAllSounds">stopAllSounds</a></li><li><a href="global.html#stopGame">stopGame</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Sat Mar 01 2025 17:50:03 GMT+0100 (Mitteleurop√§ische Normalzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
